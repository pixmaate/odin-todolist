(()=>{"use strict";function t(t,e){let n=t,o=e,c=Math.floor(Math.random()*Date.now());return{getDesc:function(){return o},getTitle:function(){return n},getID:function(){return c}}}function e(){const d=function(){const t=[];function e(e){return t[e.getID()]}return{addItem:function(e){t[e.getID()]||(t[e.getID()]=e)},getItem:e,getAllItems:function(){return t},removeItem:function(n){e(n)&&delete t[n.getID()]}}}(),i=function(){const t=[];function e(e){return t[e.getID()]}return{addProject:function(e){t[e.getID()]||(t[e.getID()]=e)},getProject:e,getAllProjects:function(){return t},removeProject:function(n){e(n)&&delete t[n.getID()]}}}(),u=t("Default","Default");function l(t,e,n){const o=document.createElement("button");return o.id="add-button",o.textContent="+",o.addEventListener("click",(o=>{r().addProjectButton(t,e,n)})),o}return i.addProject(u),console.log(i.getAllProjects()),document.getElementById("dropdown-button")||r(i).projectSelector(i.getAllProjects()),{drawContent:function(){(function(){function t(t,e,n,o,c){return function(t,e,n,o,c){let r=t,d=e,i=n,u=o,l=c,a=Math.floor(Math.random()*Date.now());function s(){return a}function m(){return r}function p(){return d}function f(){return i}function g(){return u}function v(){return l}return{setTitle:function(t){r=t},getTitle:m,setDesc:function(t){d=t},getDesc:p,setDueDate:function(t){i=t},getDueDate:f,setPrio:function(t){u=t},getPrio:g,setProject:function(t){l=t},getProject:v,getID:s,getItemString:function(){const t=[];return t.push(s()),t.push(m()),t.push(p()),t.push(f()),t.push(g()),t.push(v()),t}}}(t,e,n,o,c)}return{startFunctionality:function(n){const o=document.querySelector("#newItemBtn");document.querySelector("#dropdown-button").addEventListener("click",(t=>{e().drawItemCards(n)}));const r=c().loadFromLocal();if(null!=r){for(let e=0;e<r.length;e++){const o=t(r[e][1],r[e][2],r[e][3],r[e][4],r[e][5]);n.addItem(o,n)}e().drawItemCards(n)}o.addEventListener("click",(o=>{o.preventDefault();const r=t(document.querySelector("#itemTitle").value,document.querySelector("#descritpion").value,document.querySelector("#itemDue").value,document.querySelector("#itemPrio").value,document.querySelector("#itemProject").value);n.addItem(r,n),c().saveToLocal(r),e().drawItemCards(n)}))}}})().startFunctionality(d)},drawItemCards:function(t){var e;console.log(t.getAllItems()),n().clearDivID("cardWrapper"),(e=t,{makeItemCard:function(t){const n=document.querySelector("#dropdown-button").textContent;console.log(n);for(const[c]of Object.entries(t))("Default"==n||n==t[c].getProject())&&o(e).itemHeader(t[c])}}).makeItemCard(t.getAllItems())},drawDropdown:function t(e,o,c,d){if(d){n().clearDivID("dropdown-div",!0);const i=document.createElement("div");i.id="dropdown-div";for(const[n]of Object.entries(e)){const u=document.createElement("p"),l=document.createElement("button");l.textContent="X";const a=document.createElement("div");a.classList.add("dropdown-div-element"),u.textContent=e[n].getTitle(),u.addEventListener("click",(t=>{r().dropDownClick(t.target.textContent)})),l.addEventListener("click",(i=>{r().deleteProject(c,e[n]),t(e,o,c,d)})),a.appendChild(u),"Default"!=e[n].getTitle()&&a.appendChild(l),i.appendChild(a)}i.appendChild(l(c,e,o)),o.appendChild(i)}else if(document.getElementById("dropdown-div"))n().clearDivID("dropdown-div",!0);else{const n=document.createElement("div");n.id="dropdown-div";for(const[i]of Object.entries(e)){const u=document.createElement("div");u.classList.add("dropdown-div-element");const l=document.createElement("p");l.textContent=e[i].getTitle();const a=document.createElement("button");a.textContent="X",l.addEventListener("click",(t=>{r().dropDownClick(t.target.textContent)})),a.addEventListener("click",(n=>{r().deleteProject(c,e[i]),t(e,o,c,d)})),u.appendChild(l),"Default"!=e[i].getTitle()&&u.appendChild(a),n.appendChild(u)}n.appendChild(l(c,e,o)),o.appendChild(n)}}}}function n(){return{clearDivID:function(t,e){const n=document.getElementById(t);n.innerHTML="",e&&n.remove()},clearDivClass:function(t,e){const n=document.querySelector(t);n.innerHTML=""(e)?n.remove():""}}}function o(t){return{itemHeader:function(n){const o=document.querySelector("#cardWrapper"),c=document.createElement("div");c.id=n.getID(),c.classList.add("itemCard"),c.appendChild(function(t){const e=document.createElement("h3");return e.classList.add("itemTitle"),e.textContent=t.getTitle(),e}(n)),c.appendChild(function(t){const e=document.createElement("button");return e.textContent="Expand",e.addEventListener("click",(e=>{!function(t){const e=document.getElementById(t.getID());if(e.querySelector(".expand-detail")){const t=e.querySelector(".expand-detail");t.innerHTML="",t.remove()}else e.appendChild(function(){function t(t){const r=document.createElement("div");return r.classList.add("expand-detail"),r.appendChild(e(t)),r.appendChild(n(t)),r.appendChild(o(t)),r.appendChild(c(t)),r}function e(t){const e=document.createElement("p");return e.classList.add("itemText"),e.textContent=t.getDesc(),e}function n(t){const e=document.createElement("p");return e.classList.add("itemText"),e.textContent=t.getDueDate(),e}function o(t){const e=document.createElement("p");return e.classList.add("itemText"),e.textContent=t.getPrio(),e}function c(t){const e=document.createElement("p");return e.classList.add("itemText"),e.textContent=t.getProject(),e}return{itemDetails:t}}().itemDetails(t))}(t)})),e}(n)),c.appendChild(function(n,o){const c=document.createElement("button");return c.textContent="Delete",c.addEventListener("click",(n=>{!function(n,o){t.removeItem(o),e().drawItemCards(t)}(0,o)})),c}(c.id,n)),o.appendChild(c)}}}function c(){return{saveToLocal:function(t){t.getID();const e=t.getItemString(),n=[];if(null!=localStorage.getItem("item_list")){const t=JSON.parse(localStorage.getItem("item_list"));for(let e=0;e<t.length;e++)n.push(t[e]);n.push(e)}else n.push(e);localStorage.setItem("item_list",JSON.stringify(n))},loadFromLocal:function(){const t=JSON.parse(localStorage.getItem("item_list"));if(null!=t)return t}}}function r(o){return{projectSelector:function(t){const n=document.querySelector("#controls"),c=document.createElement("div");c.classList.add("dropdown-area");const r=document.createElement("button");r.textContent="Default",r.id="dropdown-button",r.addEventListener("click",(n=>{e().drawDropdown(t,c,o)})),c.appendChild(r),n.after(c)},dropDownClick:function(t){document.getElementById("dropdown-button").textContent=t},addProjectButton:function(o,c,r){!function(o,c,r,d){const i=document.createElement("div");i.id="project-add-div";const u=document.createElement("input"),l=document.createElement("button");u.id="proj-name",l.textContent="Ok";const a=document.createElement("button");a.textContent="Back",a.addEventListener("click",(t=>{t.preventDefault(),n().clearDivID("project-add-div",!0)})),l.addEventListener("click",(o=>{o.preventDefault();const i=document.querySelector("#proj-name").value,u=(n().clearDivID("project-add-div",!0),t(i,"Default"));!function(t,e){t.addProject(e)}(c,u),function(t){const e=document.getElementById("itemProject"),n=document.createElement("option");n.value=t,n.textContent=t,e.appendChild(n)}(i),e().drawDropdown(r,d,c,!0)})),i.appendChild(u),i.appendChild(l),i.appendChild(a),o.after(i)}(document.getElementById("add-button"),o,c,r),console.log(o.getAllProjects())},deleteProject:function(t,e){var n;document.getElementById("dropdown-button").textContent="Default",n=e.getTitle(),document.querySelector(`#itemProject option[value='${n}']`).remove(),t.removeProject(e)}}}e().drawContent()})();