(()=>{"use strict";function e(e,t){let n=e,o=t,c=Math.floor(Math.random()*Date.now());return{getDesc:function(){return o},getTitle:function(){return n},getID:function(){return c}}}function t(){const d=function(){const e=[];function t(t){return e[t.getID()]}return{addItem:function(t){e[t.getID()]||(e[t.getID()]=t)},getItem:t,getAllItems:function(){return e},removeItem:function(n){t(n)&&delete e[n.getID()]}}}(),i=function(){const e=[];function t(t){return e[t.getID()]}return{addProject:function(t){e[t.getID()]||(e[t.getID()]=t)},getProject:t,getAllProjects:function(){return e},removeProject:function(n){t(n)&&delete e[n.getID()]}}}(),l=e("Default","Default");function u(e,t,n){const o=document.createElement("button");return o.id="add-button",o.textContent="+",o.addEventListener("click",(o=>{r().addProjectButton(e,t,n)})),o}return i.addProject(l),document.getElementById("dropdown-button")||r(i).projectSelector(i.getAllProjects()),{drawContent:function(){(function(){function e(e,t,n,o,c,r){return function(e,t,n,o,c,r){let d=e,i=t,l=n,u=o,a=c,s=(console.log(r),r?(console.log("existing"),r):(console.log("new"),Math.floor(Math.random()*Date.now())));function m(){return s}function p(){return d}function f(){return i}function g(){return l}function D(){return u}function v(){return a}return{setTitle:function(e){d=e},getTitle:p,setDesc:function(e){i=e},getDesc:f,setDueDate:function(e){l=e},getDueDate:g,setPrio:function(e){u=e},getPrio:D,setProject:function(e){a=e},getProject:v,getID:m,getItemString:function(){const e=[];return e.push(m()),e.push(p()),e.push(f()),e.push(g()),e.push(D()),e.push(v()),e}}}(e,t,n,o,c,r)}return{startFunctionality:function(n){const o=document.querySelector("#newItemBtn");document.querySelector("#dropdown-button").addEventListener("click",(e=>{t().drawItemCards(n)}));const r=c().loadFromLocal();if(null!=r){for(let t=0;t<r.length;t++){const o=e(r[t][1],r[t][2],r[t][3],r[t][4],r[t][5],r[t][0]);n.addItem(o,n)}t().drawItemCards(n)}o.addEventListener("click",(o=>{o.preventDefault();const r=e(document.querySelector("#itemTitle").value,document.querySelector("#descritpion").value,document.querySelector("#itemDue").value,document.querySelector("#itemPrio").value,document.querySelector("#itemProject").value);n.addItem(r,n),c().saveToLocal(r),t().drawItemCards(n)}))}}})().startFunctionality(d)},drawItemCards:function(e){var t;n().clearDivID("cardWrapper"),(t=e,{makeItemCard:function(e){const n=document.querySelector("#dropdown-button").textContent;for(const[c]of Object.entries(e))("Default"==n||n==e[c].getProject())&&o(t).itemHeader(e[c])}}).makeItemCard(e.getAllItems())},drawDropdown:function e(t,o,c,d){if(d){n().clearDivID("dropdown-div",!0);const i=document.createElement("div");i.id="dropdown-div";for(const[n]of Object.entries(t)){const l=document.createElement("p"),u=document.createElement("button");u.textContent="X";const a=document.createElement("div");a.classList.add("dropdown-div-element"),l.textContent=t[n].getTitle(),l.addEventListener("click",(e=>{r().dropDownClick(e.target.textContent)})),u.addEventListener("click",(i=>{r().deleteProject(c,t[n]),e(t,o,c,d)})),a.appendChild(l),"Default"!=t[n].getTitle()&&a.appendChild(u),i.appendChild(a)}i.appendChild(u(c,t,o)),o.appendChild(i)}else if(document.getElementById("dropdown-div"))n().clearDivID("dropdown-div",!0);else{const n=document.createElement("div");n.id="dropdown-div";for(const[i]of Object.entries(t)){const l=document.createElement("div");l.classList.add("dropdown-div-element");const u=document.createElement("p");u.textContent=t[i].getTitle();const a=document.createElement("button");a.textContent="X",u.addEventListener("click",(e=>{r().dropDownClick(e.target.textContent)})),a.addEventListener("click",(n=>{r().deleteProject(c,t[i]),e(t,o,c,d)})),l.appendChild(u),"Default"!=t[i].getTitle()&&l.appendChild(a),n.appendChild(l)}n.appendChild(u(c,t,o)),o.appendChild(n)}}}}function n(){return{clearDivID:function(e,t){const n=document.getElementById(e);n.innerHTML="",t&&n.remove()},clearDivClass:function(e,t){const n=document.querySelector(e);n.innerHTML=""(t)?n.remove():""}}}function o(e){return{itemHeader:function(n){const o=document.querySelector("#cardWrapper"),r=document.createElement("div");r.id=n.getID(),r.classList.add("itemCard"),r.appendChild(function(e){const t=document.createElement("h3");return t.classList.add("itemTitle"),t.textContent=e.getTitle(),t}(n)),r.appendChild(function(e){const t=document.createElement("button");return t.textContent="Expand",t.addEventListener("click",(t=>{!function(e){const t=document.getElementById(e.getID());if(t.querySelector(".expand-detail")){const e=t.querySelector(".expand-detail");e.innerHTML="",e.remove()}else t.appendChild(function(){function e(e){const r=document.createElement("div");return r.classList.add("expand-detail"),r.appendChild(t(e)),r.appendChild(n(e)),r.appendChild(o(e)),r.appendChild(c(e)),r}function t(e){const t=document.createElement("p");return t.classList.add("itemText"),t.textContent=e.getDesc(),t}function n(e){const t=document.createElement("p");return t.classList.add("itemText"),t.textContent=e.getDueDate(),t}function o(e){const t=document.createElement("p");return t.classList.add("itemText"),t.textContent=e.getPrio(),t}function c(e){const t=document.createElement("p");return t.classList.add("itemText"),t.textContent=e.getProject(),t}return{itemDetails:e}}().itemDetails(e))}(e)})),t}(n)),r.appendChild(function(n,o){const r=document.createElement("button");return r.textContent="Delete",r.addEventListener("click",(n=>{!function(n,o){e.removeItem(o),c().deleteFromLocal(o),t().drawItemCards(e)}(0,o)})),r}(r.id,n)),o.appendChild(r)}}}function c(){return{saveToLocal:function(e){e.getID();const t=e.getItemString(),n=[];if(null!=localStorage.getItem("item_list")){const e=JSON.parse(localStorage.getItem("item_list"));for(let t=0;t<e.length;t++)n.push(e[t]);n.push(t)}else n.push(t);localStorage.setItem("item_list",JSON.stringify(n))},loadFromLocal:function(){const e=JSON.parse(localStorage.getItem("item_list"));if(null!=e)return e},deleteFromLocal:function(e){const t=JSON.parse(localStorage.getItem("item_list"));if(null!=t)for(let n=0;n<t.length;n++)console.log(t[n][0]),console.log(e.getID()),t[n][0]===e.getID()&&(t.splice(n,1),console.log(),localStorage.setItem("item_list",JSON.stringify(t)))}}}function r(o){return{projectSelector:function(e){const n=document.querySelector("#controls"),c=document.createElement("div");c.classList.add("dropdown-area");const r=document.createElement("button");r.textContent="Default",r.id="dropdown-button",r.addEventListener("click",(n=>{t().drawDropdown(e,c,o)})),c.appendChild(r),n.after(c)},dropDownClick:function(e){document.getElementById("dropdown-button").textContent=e},addProjectButton:function(o,c,r){!function(o,c,r,d){const i=document.createElement("div");i.id="project-add-div";const l=document.createElement("input"),u=document.createElement("button");l.id="proj-name",u.textContent="Ok";const a=document.createElement("button");a.textContent="Back",a.addEventListener("click",(e=>{e.preventDefault(),n().clearDivID("project-add-div",!0)})),u.addEventListener("click",(o=>{o.preventDefault();const i=document.querySelector("#proj-name").value,l=(n().clearDivID("project-add-div",!0),e(i,"Default"));!function(e,t){e.addProject(t)}(c,l),function(e){const t=document.getElementById("itemProject"),n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}(i),t().drawDropdown(r,d,c,!0)})),i.appendChild(l),i.appendChild(u),i.appendChild(a),o.after(i)}(document.getElementById("add-button"),o,c,r),console.log(o.getAllProjects())},deleteProject:function(e,t){var n;document.getElementById("dropdown-button").textContent="Default",n=t.getTitle(),document.querySelector(`#itemProject option[value='${n}']`).remove(),e.removeProject(t)}}}t().drawContent()})();